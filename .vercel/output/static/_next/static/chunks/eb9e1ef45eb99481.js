(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3812,e=>{"use strict";var t=e.i(44816),a=e.i(54939),s=e.i(7284),l=e.i(23191);let r=(0,a.forwardRef)(({className:e,label:a,error:r,...c},n)=>(0,t.jsxs)("div",{className:"w-full",children:[a&&(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),(0,t.jsx)("input",{ref:n,className:function(...e){return(0,l.twMerge)((0,s.clsx)(e))}("block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base sm:text-sm dark:bg-gray-800 dark:border-gray-700 text-gray-900 dark:text-gray-100 p-3 h-12",{"border-red-500 focus:border-red-500 focus:ring-red-500":r},e),...c}),r&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:r})]}));r.displayName="Input",e.s(["Input",0,r])},58291,e=>{"use strict";var t=e.i(44816),a=e.i(54939),s=e.i(3812),l=e.i(59544),r=e.i(67407);function c(){let[e,c]=(0,a.useState)(""),[n,d]=(0,a.useState)(""),[i,u]=(0,a.useState)(""),[o,x]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[h,p]=(0,a.useState)(128),[b,y]=(0,a.useState)(128),[f,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[S,I]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/admin/settings"),t=await e.json();if(t?.success&&t?.data){let e=t.data;e.accessKeyId&&c(e.accessKeyId),e.bucket&&u(e.bucket),x(e.endpoint||""),g(e.publicBase||""),p(e.iconMaxKB??128),y(e.iconMaxSize??128)}}catch{}})()},[]);let C=async t=>{t.preventDefault(),j(""),N(!0);try{let t={iconMaxKB:h,iconMaxSize:b};e&&(t.accessKeyId=e),n&&(t.secretAccessKey=n),i&&(t.bucket=i),o&&(t.endpoint=o),m&&(t.publicBase=m);let a=await fetch("/api/admin/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await a.json();s.success?j("设置已保存"):j(s.message||"保存失败")}catch{j("保存失败，请稍后重试")}finally{N(!1)}},B=async()=>{if(confirm("确定要清除所有本地存储的图标吗？此操作不可撤销。")){k(!0),I(null);try{let e=await fetch("/api/admin/icons/clear",{method:"POST"}),t=await e.json();t.success?I({message:t.message,count:t.count}):alert(t.message||"清除失败")}catch{alert("发生错误，请稍后重试")}finally{k(!1)}}};return(0,t.jsx)("div",{className:"max-w-4xl mx-auto space-y-8",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"图标设置"}),(0,t.jsxs)("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(r.CloudCog,{className:"w-5 h-5 text-purple-500"}),(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"R2 对象存储配置"})]}),(0,t.jsxs)("form",{onSubmit:C,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(s.Input,{label:"Access Key ID",value:e,onChange:e=>c(e.target.value),placeholder:"留空表示不修改"}),(0,t.jsx)(s.Input,{label:"Secret Access Key",type:"password",value:n,onChange:e=>d(e.target.value),placeholder:"留空表示不修改"}),(0,t.jsx)(s.Input,{label:"Bucket 名称",value:i,onChange:e=>u(e.target.value),placeholder:"存储桶名称"}),(0,t.jsx)(s.Input,{label:"Endpoint 终端节点",value:o,onChange:e=>x(e.target.value),placeholder:"https://<account>.r2.cloudflarestorage.com"}),(0,t.jsx)(s.Input,{label:"Public Base 公开访问地址",value:m,onChange:e=>g(e.target.value),placeholder:"https://cdn.example.com"}),(0,t.jsx)("div",{}),(0,t.jsx)(s.Input,{label:"图标体积上限 (KB)",type:"number",value:h,onChange:e=>p(parseInt(e.target.value||"128"))}),(0,t.jsx)(s.Input,{label:"图标尺寸上限 (px)",type:"number",value:b,onChange:e=>y(parseInt(e.target.value||"128"))}),(0,t.jsxs)("div",{className:"md:col-span-2 pt-4 flex items-center gap-4",children:[(0,t.jsx)(l.Button,{type:"submit",isLoading:v,children:"保存配置"}),f&&(0,t.jsx)("span",{className:`text-sm ${f.includes("成功")||f.includes("已保存")?"text-green-600":"text-red-500"}`,children:f})]})]})]}),(0,t.jsxs)("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-4",children:(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"本地存储管理"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"如果您已成功配置 R2 并希望释放服务器空间，可以清除本地存储的图标文件。"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.Button,{variant:"secondary",onClick:B,isLoading:w,className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20",children:"清除所有本地图标"}),S&&(0,t.jsx)("span",{className:"text-sm text-green-600 font-medium",children:S.message})]})]})]})})}e.s(["default",()=>c])}]);