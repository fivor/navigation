(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3812,e=>{"use strict";var t=e.i(44816),a=e.i(54939),s=e.i(7284),r=e.i(23191);let l=(0,a.forwardRef)(({className:e,label:a,error:l,...d},i)=>(0,t.jsxs)("div",{className:"w-full",children:[a&&(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),(0,t.jsx)("input",{ref:i,className:function(...e){return(0,r.twMerge)((0,s.clsx)(e))}("block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base sm:text-sm dark:bg-gray-800 dark:border-gray-700 text-gray-900 dark:text-gray-100 p-3 h-12",{"border-red-500 focus:border-red-500 focus:ring-red-500":l},e),...d}),l&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:l})]}));l.displayName="Input",e.s(["Input",0,l])},41516,e=>{"use strict";var t=e.i(44816),a=e.i(54939),s=e.i(3812),r=e.i(59544),l=e.i(66254),d=e.i(95588);function i(){let e=(0,d.useRouter)(),[i,n]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[b,f]=(0,a.useState)(!1),y=async t=>{if(t.preventDefault(),p(""),u&&u!==m)return void p("两次输入的新密码不一致");if(!o&&!u)return void p("请至少修改邮箱或密码中的一项");f(!0);try{let t=await fetch("/api/admin/security",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:i,newEmail:o||void 0,newPassword:u||void 0})}),a=await t.json();a.success?(p("保存成功，请使用新邮箱/密码重新登录"),await fetch("/api/auth/logout",{method:"POST"}),e.push("/admin/login"),e.refresh()):p(a.message||"保存失败")}catch{p("保存失败，请稍后重试")}finally{f(!1)}};return(0,t.jsx)("div",{className:"max-w-4xl mx-auto space-y-8",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"安全设置"}),(0,t.jsxs)("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(l.Shield,{className:"w-5 h-5 text-blue-500"}),(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"账号安全"})]}),(0,t.jsxs)("form",{onSubmit:y,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(s.Input,{label:"当前密码",type:"password",value:i,onChange:e=>n(e.target.value),required:!0,placeholder:"确认身份必填"}),(0,t.jsx)("div",{}),(0,t.jsx)(s.Input,{label:"新邮箱",type:"email",value:o,onChange:e=>c(e.target.value),placeholder:"填写则更新绑定邮箱"}),(0,t.jsx)("div",{}),(0,t.jsx)(s.Input,{label:"新密码",type:"password",value:u,onChange:e=>x(e.target.value),placeholder:"不修改请留空，至少5位"}),(0,t.jsx)(s.Input,{label:"确认新密码",type:"password",value:m,onChange:e=>h(e.target.value),placeholder:"再次输入新密码"}),(0,t.jsxs)("div",{className:"md:col-span-2 pt-4 flex items-center gap-4",children:[(0,t.jsx)(r.Button,{type:"submit",isLoading:b,children:"保存并重新登录"}),g&&(0,t.jsx)("span",{className:`text-sm ${g.includes("成功")?"text-green-600":"text-red-500"}`,children:g})]})]})]})]})})}e.s(["default",()=>i])}]);