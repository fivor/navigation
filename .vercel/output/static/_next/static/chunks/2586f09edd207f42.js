(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3812,e=>{"use strict";var t=e.i(44816),a=e.i(54939),r=e.i(7284),s=e.i(23191);let l=(0,a.forwardRef)(({className:e,label:a,error:l,...i},d)=>(0,t.jsxs)("div",{className:"w-full",children:[a&&(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),(0,t.jsx)("input",{ref:d,className:function(...e){return(0,s.twMerge)((0,r.clsx)(e))}("block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-base sm:text-sm dark:bg-gray-800 dark:border-gray-700 text-gray-900 dark:text-gray-100 p-3 h-12",{"border-red-500 focus:border-red-500 focus:ring-red-500":l},e),...i}),l&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:l})]}));l.displayName="Input",e.s(["Input",0,l])},62333,e=>{"use strict";var t=e.i(44816),a=e.i(54939),r=e.i(59544),s=e.i(3812),l=e.i(39369),i=e.i(95588);function d({initialCategories:e}){let d=(0,i.useRouter)(),[n,c]=(0,a.useState)(e),[o,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1),[p,y]=(0,a.useState)({}),b=async e=>{e.preventDefault(),h(!0);try{let e=m?`/api/categories/${p.id}`:"/api/categories",t={name:p.name,icon:p.icon||null,parent_id:p.parent_id||null,sort_order:p.sort_order},a=await fetch(e,{method:m?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok)x(!1),d.refresh(),window.location.reload();else{let e=await a.json();alert(e.message||"操作失败")}}catch(e){console.error(e),alert("发生错误")}finally{h(!1)}},f=async e=>{if(confirm("确定要删除吗？注意：如果有下级分类或关联的链接，删除将失败。"))try{let t=await fetch(`/api/categories/${e}`,{method:"DELETE"});if(t.ok)d.refresh(),window.location.reload();else{let e=await t.json();alert(e.message||"删除失败")}}catch(e){console.error(e),alert("删除出错")}},j=n.filter(e=>!m||e.id!==p.id);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"分类管理"}),(0,t.jsx)(r.Button,{onClick:()=>{u(!1),y({}),x(!0)},children:"添加分类"})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-lg",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,t.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"名称"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"图标 (Lucide)"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"父级分类"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"排序"}),(0,t.jsx)("th",{className:"relative px-6 py-3",children:(0,t.jsx)("span",{className:"sr-only",children:"编辑"})})]})}),(0,t.jsxs)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[n.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:[e.name,(0,t.jsx)("span",{className:"ml-2 inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 dark:bg-blue-400/10 dark:text-blue-400 dark:ring-blue-400/20",title:`当前分类共收录 ${e.links_count} 条链接`,children:e.links_count})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.icon||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.parent_name||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.sort_order}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,t.jsx)("button",{onClick:()=>{u(!0),y(e),x(!0)},className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-4",children:"编辑"}),(0,t.jsx)("button",{onClick:()=>f(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"删除"})]})]},e.id)),0===n.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"暂无分类。"})})]})]})}),(0,t.jsxs)(l.Dialog,{open:o,onClose:()=>x(!1),className:"relative z-50",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,t.jsxs)(l.DialogPanel,{className:"mx-auto max-w-sm rounded bg-white dark:bg-gray-800 p-6 w-full shadow-xl",children:[(0,t.jsx)(l.DialogTitle,{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-4",children:m?"编辑分类":"添加分类"}),(0,t.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,t.jsx)(s.Input,{label:"名称",required:!0,value:p.name||"",onChange:e=>y({...p,name:e.target.value})}),(0,t.jsx)(s.Input,{label:"图标 (Lucide 图标名，如: Layout, Book, Heart)",value:p.icon||"",onChange:e=>y({...p,icon:e.target.value}),placeholder:"例如: Heart"}),(0,t.jsx)(s.Input,{label:"排序权重",type:"number",value:p.sort_order||0,onChange:e=>y({...p,sort_order:parseInt(e.target.value)})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"父级分类"}),(0,t.jsxs)("select",{className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-800 dark:border-gray-700 dark:text-white p-2",value:p.parent_id||"",onChange:e=>y({...p,parent_id:e.target.value?Number(e.target.value):null}),children:[(0,t.jsx)("option",{value:"",children:"无 (作为顶级分类)"}),j.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)(r.Button,{type:"button",variant:"ghost",onClick:()=>x(!1),children:"取消"}),(0,t.jsx)(r.Button,{type:"submit",isLoading:g,children:"保存"})]})]})]})})]})]})}e.s(["CategoryManager",()=>d])}]);